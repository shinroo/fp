{{define "stylesheets"}}
<style>
    .carousel-container {
        max-width: 500px;
        margin: 0 auto;
    }

    .carousel-inner {
        max-height: none;
        width: 100%;
        /* Ensure consistent width */
    }

    .carousel-item {
        display: flex;
        flex-direction: column;
        width: 100%;
        /* Ensure items take full width */
        /* Add transition for smooth animation if needed */
        transition: transform 0.6s ease-in-out;
    }

    .carousel-image-container {
        flex: 1;
    }

    .carousel-image-container img {
        width: 100%;
        height: auto;
        max-height: 500px;
        object-fit: contain;
    }

    .carousel-caption-container {
        padding: 15px;
        text-align: center;
        background: white;
        /* Optional background */
        color: black;
    }

    /* Override Bootstrap's default caption styles */
    .carousel-caption {
        position: static;
        right: auto;
        bottom: auto;
        left: auto;
        padding: 0;
        color: inherit;
    }

    /* Optional: Add some spacing between items */
    .carousel-item {
        margin-bottom: 20px;
        will-change: transform;
    }

    /* Ensure carousel container is positioned relatively */
    #exploreCarousel {
        position: relative;
        width: 100%;
        /* Ensure it takes full width */
        overflow: hidden;
        /* Prevent content from overflowing during transition */
    }

    /* Style for both buttons */
    .carousel-control-prev,
    .carousel-control-next {
        width: 40px !important;
        height: 40px !important;
        background-color: #233661 !important;
        border-radius: 50% !important;
        top: 50% !important;
        transform: translateY(-50%) !important;
        opacity: 1 !important;
        position: absolute !important;
        /* Required for proper placement */
        z-index: 10 !important;
        /* Ensure buttons appear above other elements */
    }

    /* Position the previous button */
    .carousel-control-prev {
        left: 15px !important;
    }

    /* Position the next button */
    .carousel-control-next {
        right: 15px !important;
    }

    /* Style the icons (make them white and larger if needed) */
    .carousel-control-prev-icon,
    .carousel-control-next-icon {
        filter: brightness(0) invert(1) !important;
        /* Turns black icon to white */
        width: 24px !important;
        /* Adjust size if needed */
        height: 24px !important;
    }
</style>
{{end}}

{{define "title"}}Explore{{end}}

{{define "content"}}
<p class="text-center mb-4">Dogs will appear here in order of their suitability to you, based on your profile</p>

<div class="carousel-container">
    <div id="exploreCarousel" class="carousel slide" data-bs-interval="false">
        <div class="carousel-inner" id="explore-results"></div>
        <button class="carousel-control-prev" type="button" data-bs-target="#exploreCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#exploreCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>

{{end}}

{{define "scripts"}}
<script>
    document.addEventListener("DOMContentLoaded", (event) => {
        // Define the URL
        var url = "/api/explore";

        // Send the POST request
        fetch(url, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
                "Authorization": authToken
            },
        })
            .then((response) => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then((responseData) => {
                console.log("Success:", responseData);

                // Display the search results
                const exploreResults = document.getElementById("explore-results");
                exploreResults.innerHTML = "";

                let count = 0;

                // Inside your fetch success handler:
                responseData.results.forEach((result) => {
                    const petCarouselItem = document.createElement("div");
                    if (count == 0) {
                        petCarouselItem.classList.add("carousel-item", "active", "card", "mb-3");
                    } else {
                        petCarouselItem.classList.add("carousel-item", "card", "mb-3");
                    }

                    // Image container
                    const imageContainer = document.createElement("div");
                    imageContainer.classList.add("carousel-image-container");

                    const petCarouselImage = document.createElement("img");
                    petCarouselImage.src = result.image_url;
                    petCarouselImage.alt = result.name;
                    petCarouselImage.classList.add("d-block", "w-100");

                    imageContainer.appendChild(petCarouselImage);

                    // Caption container (now separate from image)
                    const captionContainer = document.createElement("div");
                    captionContainer.classList.add("carousel-caption-container");

                    const petCarouselCaptionTitle = document.createElement("h5");
                    petCarouselCaptionTitle.textContent = result.name;

                    const petCarouselCaptionText = document.createElement("p");
                    petCarouselCaptionText.textContent = `Our number ${count + 1} suggestion • ${result.life_stage} • ${result.gender}`;

                    captionContainer.appendChild(petCarouselCaptionTitle);
                    captionContainer.appendChild(petCarouselCaptionText);

                    // Add both containers to carousel item
                    petCarouselItem.appendChild(imageContainer);
                    petCarouselItem.appendChild(captionContainer);

                    exploreResults.appendChild(petCarouselItem);

                    count++;
                });
            })
            .catch((error) => {
                console.error("Error:", error);
            });
    })
</script>
{{end}}